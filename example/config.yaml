defaults:
  - override hydra/sweeper: orion

hydra:
  job:
    env_set:
      PREVIOUS_CHECKPOINT: ${hydra.sweeper.orion.previous_checkpoint}
      CURRENT_CHECKPOINT: ${hydra.runtime.output_dir}

  # makes sure each multirun ends up in a unique folder
  # the defaults can make overlapping folders
  sweep:
    dir: multirun/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.sweeper.orion.name}/${hydra.sweeper.orion.uuid}/${hydra.job.id}

  sweeper:
    # default parametrization of the search space
    params:
      optimizer:
        name: "choices(['Adam', 'SGD'])"
        lr: "uniform(0, 1)"
      dropout: "uniform(0, 1)"
      batch_size: "uniform(4, 16, discrete=True)"
      epoch: "fidelity(3, 100)"

    orion:
      name: 'experiment'
      version: '1'

    algorithm:
      type: hyperband
      config:
        seed: 1

    worker:
      n_workers: -1
      max_broken: 3
      max_trials: 100

    storage:
      type: legacy

      database:
        type: pickleddb
        host: 'database.pkl'

optimizer:
  name: 'Adam'
  lr: 0.01

epoch: 100
dropout: 0.6
batch_size: 8

# if true, simulate a failure by raising an exception
error: false
return_type: float

